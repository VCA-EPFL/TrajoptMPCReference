

import numpy as np
from overloading import matrix_







# [u1,u2]=u=np.array([0.,0.])
# [q1,q2,q1_dot,q2_dot]=np.array([1.,1.,1.,1.])


# xg=np.array([0.2,0.2,0.2,0.2])
# Q=np.diag([1.0,1.0, 1.0,1.0])
# R = np.diag([0.1, 0.1])



Q=matrix_([[1.0, 0.0, 0.0, 0.0],
 [0.0, 1.0, 0.0, 0.0],
 [0.0, 0.0, 1.0, 0.0],
 [0.0, 0.0, 0.0, 1.0]])
R=matrix_([[0.1, 0.0],
 [0.0, 0.1]])
xg=matrix_([0.2,0.2,0.2,0.2])

def cost_control_in(q1,q2,q1_dot,q2_dot,u,Q,R,xg):
    return float(0.5*(matrix_([[np.cos(q1) + np.cos(q1 + q2), np.sin(q1) + np.sin(q1 + q2), q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2), q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2)]]) -xg.transpose())@Q\
        @(matrix_([np.cos(q1) + np.cos(q1 + q2),np.sin(q1) + np.sin(q1 + q2),q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2), q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2)]) - xg)\
      + 0.5*(u.transpose()@R@u))

def cost_control_off(q1,q2,q1_dot,q2_dot,Q,xg):
    return float(0.5*(matrix_([[np.cos(q1) + np.cos(q1 + q2), np.sin(q1) + np.sin(q1 + q2), q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2), q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2)]]) -xg.transpose())@Q\
        @(matrix_([np.cos(q1) + np.cos(q1 + q2),np.sin(q1) + np.sin(q1 + q2),q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2), q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2)]) - xg))

# print(cost_control_in(0.,0.,0.,0.,np.array([0.,0.]), Q,R,xg))


def gradient_cost_in(q1,q2,q1_dot,q2_dot,u1,u2,Q,R,xg):
    return matrix_([[0.5*(q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) \
                + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3]) + 0.5*(q1_dot*(-np.cos(q1) - np.cos(q1 + q2)) \
                - q2_dot*np.cos(q1 + q2))*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2]\
                + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2]) + 0.5*(-np.sin(q1) - np.sin(q1 + q2))*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 0] \
                + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 0] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 0] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 0]) + 0.5*(np.cos(q1) + np.cos(q1 + q2))\
                * ((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 1] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 1] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 1] \
                + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 1]) + (q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*((0.5*q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] \
                + (0.5*q1_dot*(-np.cos(q1) - np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2]) + (q1_dot*(np.cos(q1) + np.cos(q1 + q2))+ q2_dot*np.cos(q1 + q2) - xg[3])*((0.5*q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (0.5*q1_dot*(-np.cos(q1) - np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3]\
                + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3]) + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*((0.5*q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 1]\
                + (0.5*q1_dot*(-np.cos(q1) - np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 1] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 1]) + (np.cos(q1) + np.cos(q1 + q2) - xg[0])\
                * ((0.5*q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 0] + (0.5*q1_dot*(-np.cos(q1) - np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 0] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 0] + (0.5*np.cos(q1) \
                + 0.5*np.cos(q1 + q2))*Q[1, 0]), 0.5*(-q1_dot*np.sin(q1 + q2) - q2_dot*np.sin(q1 + q2))*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) \
                - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3]) + 0.5*(-q1_dot*np.cos(q1 + q2) - q2_dot*np.cos(q1 + q2))*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) \
                - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2]) + (q1_dot*(-np.sin(q1)\
                - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*((-0.5*q1_dot*np.sin(q1 + q2) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*np.cos(q1 + q2) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2]\
                + 0.5*np.cos(q1 + q2)*Q[1, 2]) + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*((-0.5*q1_dot*np.sin(q1 + q2) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-0.5*q1_dot*np.cos(q1 + q2) - 0.5*q2_dot*np.cos(q1 + q2))\
                * Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3]) + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*((-0.5*q1_dot*np.sin(q1 + q2) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 1] + (-0.5*q1_dot*np.cos(q1 + q2) - 0.5*q2_dot*np.cos(q1 + q2))\
                * Q[2, 1] - 0.5*np.sin(q1 + q2)*Q[0, 1] + 0.5*np.cos(q1 + q2)*Q[1, 1]) + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*((-0.5*q1_dot*np.sin(q1 + q2) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 0] + (-0.5*q1_dot*np.cos(q1 + q2) - 0.5*q2_dot*np.cos(q1 + q2))\
                * Q[2, 0] - 0.5*np.sin(q1 + q2)*Q[0, 0] + 0.5*np.cos(q1 + q2)*Q[1, 0]) - 0.5*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 0] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])\
                * Q[3, 0] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 0] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 0])*np.sin(q1 + q2) + 0.5*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 1] + (q1_dot*(np.cos(q1)\
                + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 1] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 1] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 1])*np.cos(q1 + q2), ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 0]\
                + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) \
                + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2])*(q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] \
                + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) + 0.5*(-np.sin(q1) - np.sin(q1 + q2))*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) \
                - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2]) + 0.5*(np.cos(q1) \
                + np.cos(q1 + q2))*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])\
                * Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3]), (-0.5*np.sin(q1 + q2)*Q[2, 0] + 0.5*np.cos(q1 + q2)*Q[3, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[2, 1] + 0.5*np.cos(q1 + q2)*Q[3, 1])\
                * (np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2])*(q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3])\
                * (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) - 0.5*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])\
                * Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.sin(q1 + q2) + 0.5*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) \
                + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.cos(q1 + q2), 1.0*u1*R[0, 0] + 0.5*u2*R[0, 1] \
                + 0.5*u2*R[1, 0], 0.5*u1*R[0, 1] + 0.5*u1*R[1, 0] + 1.0*u2*R[1, 1]]])






def gradient_cost_off(q1,q2,q1_dot,q2_dot,Q,xg):


    return matrix_([[0.5*(q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3]\
                 + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) \
                - xg[0])*Q[0, 3]) + 0.5*(q1_dot*(-np.cos(q1) - np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] \
                + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2]) \
                + 0.5*(-np.sin(q1) - np.sin(q1 + q2))*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 0] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) \
                - xg[3])*Q[3, 0] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 0] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 0]) + 0.5*(np.cos(q1) + np.cos(q1 + q2))*((q1_dot*(-np.sin(q1) \
                - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 1] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 1] + (np.sin(q1) + np.sin(q1 + q2) \
                - xg[1])*Q[1, 1] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 1]) + (q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*((0.5*q1_dot*(-np.sin(q1) \
                - np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (0.5*q1_dot*(-np.cos(q1) - np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] \
                + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2]) + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*((0.5*q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) \
                - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (0.5*q1_dot*(-np.cos(q1) - np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] \
                + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3]) + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*((0.5*q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 1] \
                + (0.5*q1_dot*(-np.cos(q1) - np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 1] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 1]) \
                + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*((0.5*q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 0] + (0.5*q1_dot*(-np.cos(q1) - np.cos(q1 + q2)) \
                - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 0] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 0]), 0.5*(-q1_dot*np.sin(q1 + q2) \
                - q2_dot*np.sin(q1 + q2))*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) \
                - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3]) + 0.5*(-q1_dot*np.cos(q1 + q2) - q2_dot*np.cos(q1 + q2))\
                * ((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) \
                + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2]) + (q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])\
                * ((-0.5*q1_dot*np.sin(q1 + q2) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*np.cos(q1 + q2) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2] \
                + 0.5*np.cos(q1 + q2)*Q[1, 2]) + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*((-0.5*q1_dot*np.sin(q1 + q2) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] \
                + (-0.5*q1_dot*np.cos(q1 + q2) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3]) + (np.sin(q1) + np.sin(q1 + q2) \
                - xg[1])*((-0.5*q1_dot*np.sin(q1 + q2) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 1] + (-0.5*q1_dot*np.cos(q1 + q2) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 1] - 0.5*np.sin(q1 + q2)*Q[0, 1] \
                + 0.5*np.cos(q1 + q2)*Q[1, 1]) + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*((-0.5*q1_dot*np.sin(q1 + q2) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 0] + (-0.5*q1_dot*np.cos(q1 + q2) \
                - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 0] - 0.5*np.sin(q1 + q2)*Q[0, 0] + 0.5*np.cos(q1 + q2)*Q[1, 0]) - 0.5*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 0] \
                + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 0] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 0] + (np.cos(q1) + np.cos(q1 + q2) \
                - xg[0])*Q[0, 0])*np.sin(q1 + q2) + 0.5*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 1] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) \
                + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 1] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 1] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 1])*np.cos(q1 + q2), ((-0.5*np.sin(q1)\
                - 0.5*np.sin(q1 + q2))*Q[2, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 1] + (0.5*np.cos(q1) \
                + 0.5*np.cos(q1 + q2))*Q[3, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2])*(q1_dot*(-np.sin(q1) \
                - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) \
                + q2_dot*np.cos(q1 + q2) - xg[3]) + 0.5*(-np.sin(q1) - np.sin(q1 + q2))*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) \
                + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2]) + 0.5*(np.cos(q1) + np.cos(q1 + q2))*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) \
                - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] \
                + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3]), (-0.5*np.sin(q1 + q2)*Q[2, 0] + 0.5*np.cos(q1 + q2)*Q[3, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[2, 1]\
                + 0.5*np.cos(q1 + q2)*Q[3, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2])*(q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) \
                - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) \
                - 0.5*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] \
                + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.sin(q1 + q2) + 0.5*((q1_dot*(-np.sin(q1) - np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) \
                - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.cos(q1 + q2)]])






def hessian_cost_in(q1,q2,q1_dot,q2_dot,u1,u2,Q,R,xg):
    return matrix_([[(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*((-1.0*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 1.0*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-1.0*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 1.0*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-1.0*np.sin(q1) - 1.0*np.sin(q1 + q2))*Q[0, 3] + (np.cos(q1) + np.cos(q1 + q2))*Q[1, 3]) + (0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) + 0.5*q2_dot*np.sin(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*((-1.0*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 1.0*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-1.0*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 1.0*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-1.0*np.sin(q1) - 1.0*np.sin(q1 + q2))*Q[0, 2] + (np.cos(q1) + np.cos(q1 + q2))*Q[1, 2]) + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3]) + (-np.sin(q1) - np.sin(q1 + q2))*((-1.0*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 1.0*q2_dot*np.sin(q1 + q2))*Q[3, 0] + (-1.0*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 1.0*q2_dot*np.cos(q1 + q2))*Q[2, 0] + (-1.0*np.sin(q1) - 1.0*np.sin(q1 + q2))*Q[0, 0] + (np.cos(q1) + np.cos(q1 + q2))*Q[1, 0]) + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 1] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 1] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 1] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 1]) + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 0] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 0] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 0] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 0]) + (np.cos(q1) + np.cos(q1 + q2))*((-1.0*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 1.0*q2_dot*np.sin(q1 + q2))*Q[3, 1] + (-1.0*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 1.0*q2_dot*np.cos(q1 + q2))*Q[2, 1] + (-1.0*np.sin(q1) - 1.0*np.sin(q1 + q2))*Q[0, 1] + (np.cos(q1) + np.cos(q1 + q2))*Q[1, 1]) + (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*((0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) + 0.5*q2_dot*np.sin(q1 + q2))*Q[2, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[3, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[1, 2] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[0, 2]) + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*((0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) + 0.5*q2_dot*np.sin(q1 + q2))*Q[2, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[3, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[1, 3] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[0, 3]) + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*((0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) + 0.5*q2_dot*np.sin(q1 + q2))*Q[2, 1] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[3, 1] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[1, 1] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[0, 1]) + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*((0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) + 0.5*q2_dot*np.sin(q1 + q2))*Q[2, 0] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[3, 0] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[1, 0] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[0, 0]), -(q1_dot + q2_dot)*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3])*np.sin(q1 + q2) + 0.5*(q1_dot + q2_dot)*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.sin(q1 + q2) - 0.5*(q1_dot + q2_dot)*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.cos(q1 + q2) + (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2] + 0.5*np.cos(q1 + q2)*Q[1, 2]) + (-np.sin(q1) - np.sin(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 0] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 0] - 0.5*np.sin(q1 + q2)*Q[0, 0] + 0.5*np.cos(q1 + q2)*Q[1, 0]) + (np.cos(q1) + np.cos(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 1] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 1] - 0.5*np.sin(q1 + q2)*Q[0, 1] + 0.5*np.cos(q1 + q2)*Q[1, 1]) + (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 2] - 0.5*np.sin(q1 + q2)*Q[1, 2] - 0.5*np.cos(q1 + q2)*Q[0, 2]) + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 3] - 0.5*np.sin(q1 + q2)*Q[1, 3] - 0.5*np.cos(q1 + q2)*Q[0, 3]) + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 1] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 1] - 0.5*np.sin(q1 + q2)*Q[1, 1] - 0.5*np.cos(q1 + q2)*Q[0, 1]) + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 0] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 0] - 0.5*np.sin(q1 + q2)*Q[1, 0] - 0.5*np.cos(q1 + q2)*Q[0, 0]) - ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 0] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 0] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 0])*np.sin(q1 + q2) + ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 1] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 1] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 1])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 0] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 0] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 0] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 0])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 1] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 1] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 1] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 1])*np.sin(q1 + q2), (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 0])*(-np.sin(q1) - np.sin(q1 + q2)) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 1])*(np.cos(q1) + np.cos(q1 + q2)) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 0] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 1] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 2] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 3] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) + (-np.sin(q1) - np.sin(q1 + q2))*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2]) + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3]) + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2]) + (np.cos(q1) + np.cos(q1 + q2))*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3]), (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*(-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*(-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2]) + (-0.5*np.sin(q1 + q2)*Q[2, 0] + 0.5*np.cos(q1 + q2)*Q[3, 0])*(-np.sin(q1) - np.sin(q1 + q2)) + (-0.5*np.sin(q1 + q2)*Q[2, 1] + 0.5*np.cos(q1 + q2)*Q[3, 1])*(np.cos(q1) + np.cos(q1 + q2)) + (-0.5*np.sin(q1 + q2)*Q[3, 0] - 0.5*np.cos(q1 + q2)*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[3, 1] - 0.5*np.cos(q1 + q2)*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[3, 2] - 0.5*np.cos(q1 + q2)*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[3, 3] - 0.5*np.cos(q1 + q2)*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) - ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2])*np.sin(q1 + q2) + ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.sin(q1 + q2), 0, 0],[-(q1_dot + q2_dot)*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3])*np.sin(q1 + q2) + 0.5*(q1_dot + q2_dot)*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.sin(q1 + q2) - 0.5*(q1_dot + q2_dot)*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.cos(q1 + q2) + (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2] + 0.5*np.cos(q1 + q2)*Q[1, 2]) + (-np.sin(q1) - np.sin(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 0] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 0] - 0.5*np.sin(q1 + q2)*Q[0, 0] + 0.5*np.cos(q1 + q2)*Q[1, 0]) + (np.cos(q1) + np.cos(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 1] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 1] - 0.5*np.sin(q1 + q2)*Q[0, 1] + 0.5*np.cos(q1 + q2)*Q[1, 1]) + (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 2] - 0.5*np.sin(q1 + q2)*Q[1, 2] - 0.5*np.cos(q1 + q2)*Q[0, 2]) + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 3] - 0.5*np.sin(q1 + q2)*Q[1, 3] - 0.5*np.cos(q1 + q2)*Q[0, 3]) + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 1] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 1] - 0.5*np.sin(q1 + q2)*Q[1, 1] - 0.5*np.cos(q1 + q2)*Q[0, 1]) + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 0] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 0] - 0.5*np.sin(q1 + q2)*Q[1, 0] - 0.5*np.cos(q1 + q2)*Q[0, 0]) - ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 0] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 0] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 0])*np.sin(q1 + q2) + ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 1] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 1] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 1])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 0] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 0] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 0] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 0])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 1] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 1] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 1] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 1])*np.sin(q1 + q2), 0.5*(q1_dot + q2_dot)*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.sin(q1 + q2) - 0.5*(q1_dot + q2_dot)*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.cos(q1 + q2) - (q1_dot + q2_dot)*(-1.0*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 1.0*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 1.0*np.sin(q1 + q2)*Q[0, 2] + 1.0*np.cos(q1 + q2)*Q[1, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*(-1.0*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 1.0*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 1.0*np.sin(q1 + q2)*Q[0, 3] + 1.0*np.cos(q1 + q2)*Q[1, 3])*np.sin(q1 + q2) + (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 2] - 0.5*np.sin(q1 + q2)*Q[1, 2] - 0.5*np.cos(q1 + q2)*Q[0, 2]) + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 3] - 0.5*np.sin(q1 + q2)*Q[1, 3] - 0.5*np.cos(q1 + q2)*Q[0, 3]) + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 1] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 1] - 0.5*np.sin(q1 + q2)*Q[1, 1] - 0.5*np.cos(q1 + q2)*Q[0, 1]) + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 0] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 0] - 0.5*np.sin(q1 + q2)*Q[1, 0] - 0.5*np.cos(q1 + q2)*Q[0, 0]) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 0] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 0] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 0] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 0])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 1] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 1] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 1] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 1])*np.sin(q1 + q2) - (-1.0*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 0] - 1.0*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 0] - 1.0*np.sin(q1 + q2)*Q[0, 0] + 1.0*np.cos(q1 + q2)*Q[1, 0])*np.sin(q1 + q2) + (-1.0*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 1] - 1.0*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 1] - 1.0*np.sin(q1 + q2)*Q[0, 1] + 1.0*np.cos(q1 + q2)*Q[1, 1])*np.cos(q1 + q2), -(q1_dot + q2_dot)*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3])*np.sin(q1 + q2) - ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 0])*np.sin(q1 + q2) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 1])*np.cos(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[3, 0] - 0.5*np.cos(q1 + q2)*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[3, 1] - 0.5*np.cos(q1 + q2)*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[3, 2] - 0.5*np.cos(q1 + q2)*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[3, 3] - 0.5*np.cos(q1 + q2)*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) + (-np.sin(q1) - np.sin(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2] + 0.5*np.cos(q1 + q2)*Q[1, 2]) + (np.cos(q1) + np.cos(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3]) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.sin(q1 + q2), -(q1_dot + q2_dot)*(-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*(-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3])*np.sin(q1 + q2) - (-0.5*np.sin(q1 + q2)*Q[2, 0] + 0.5*np.cos(q1 + q2)*Q[3, 0])*np.sin(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[2, 1] + 0.5*np.cos(q1 + q2)*Q[3, 1])*np.cos(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[3, 0] - 0.5*np.cos(q1 + q2)*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[3, 1] - 0.5*np.cos(q1 + q2)*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[3, 2] - 0.5*np.cos(q1 + q2)*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[3, 3] - 0.5*np.cos(q1 + q2)*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.sin(q1 + q2) - (-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2] + 0.5*np.cos(q1 + q2)*Q[1, 2])*np.sin(q1 + q2) + (-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3])*np.cos(q1 + q2), 0, 0],[(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 0])*(-np.sin(q1) - np.sin(q1 + q2)) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 1])*(np.cos(q1) + np.cos(q1 + q2)) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 0] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 1] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 2] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 3] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) + (-np.sin(q1) - np.sin(q1 + q2))*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2]) + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3]) + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2]) + (np.cos(q1) + np.cos(q1 + q2))*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3]), -(q1_dot + q2_dot)*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3])*np.sin(q1 + q2) - ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 0])*np.sin(q1 + q2) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 1])*np.cos(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[3, 0] - 0.5*np.cos(q1 + q2)*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[3, 1] - 0.5*np.cos(q1 + q2)*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[3, 2] - 0.5*np.cos(q1 + q2)*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[3, 3] - 0.5*np.cos(q1 + q2)*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) + (-np.sin(q1) - np.sin(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2] + 0.5*np.cos(q1 + q2)*Q[1, 2]) + (np.cos(q1) + np.cos(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3]) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.sin(q1 + q2),   ((-1.0*np.sin(q1) - 1.0*np.sin(q1 + q2))*Q[2, 2] + (np.cos(q1) + np.cos(q1 + q2))*Q[3, 2])*(-np.sin(q1) - np.sin(q1 + q2)) + ((-1.0*np.sin(q1) - 1.0*np.sin(q1 + q2))*Q[2, 3] + (np.cos(q1) + np.cos(q1 + q2))*Q[3, 3])*(np.cos(q1) + np.cos(q1 + q2)),  -((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2])*np.sin(q1 + q2) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3])*np.cos(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2])*(-np.sin(q1) - np.sin(q1 + q2)) + (-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3])*(np.cos(q1) + np.cos(q1 + q2)),0, 0],[(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*(-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*(-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2]) + (-0.5*np.sin(q1 + q2)*Q[2, 0] + 0.5*np.cos(q1 + q2)*Q[3, 0])*(-np.sin(q1) - np.sin(q1 + q2)) + (-0.5*np.sin(q1 + q2)*Q[2, 1] + 0.5*np.cos(q1 + q2)*Q[3, 1])*(np.cos(q1) + np.cos(q1 + q2)) + (-0.5*np.sin(q1 + q2)*Q[3, 0] - 0.5*np.cos(q1 + q2)*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[3, 1] - 0.5*np.cos(q1 + q2)*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[3, 2] - 0.5*np.cos(q1 + q2)*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[3, 3] - 0.5*np.cos(q1 + q2)*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) - ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2])*np.sin(q1 + q2) + ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.sin(q1 + q2), -(q1_dot + q2_dot)*(-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*(-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3])*np.sin(q1 + q2) - (-0.5*np.sin(q1 + q2)*Q[2, 0] + 0.5*np.cos(q1 + q2)*Q[3, 0])*np.sin(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[2, 1] + 0.5*np.cos(q1 + q2)*Q[3, 1])*np.cos(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[3, 0] - 0.5*np.cos(q1 + q2)*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[3, 1] - 0.5*np.cos(q1 + q2)*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[3, 2] - 0.5*np.cos(q1 + q2)*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[3, 3] - 0.5*np.cos(q1 + q2)*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.sin(q1 + q2) - (-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2] + 0.5*np.cos(q1 + q2)*Q[1, 2])*np.sin(q1 + q2) + (-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3])*np.cos(q1 + q2),   -((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2])*np.sin(q1 + q2) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3])*np.cos(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2])*(-np.sin(q1) - np.sin(q1 + q2)) + (-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3])*(np.cos(q1) + np.cos(q1 + q2)), -(-1.0*np.sin(q1 + q2)*Q[2, 2] + 1.0*np.cos(q1 + q2)*Q[3, 2])*np.sin(q1 + q2) + (-1.0*np.sin(q1 + q2)*Q[2, 3] + 1.0*np.cos(q1 + q2)*Q[3, 3])*np.cos(q1 + q2), 0, 0],[ 0, 0,   0, 0, 1.0*R[0, 0], 0.5*R[0, 1] + 0.5*R[1, 0]],[ 0,0, 0,  0, 0.5*R[0, 1] + 0.5*R[1, 0], 1.0*R[1, 1]]])




def hessian_cost_off(q1,q2,q1_dot,q2_dot,Q,xg): 
    return matrix_([[(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*((-1.0*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 1.0*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-1.0*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 1.0*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-1.0*np.sin(q1) - 1.0*np.sin(q1 + q2))*Q[0, 3] + (np.cos(q1) + np.cos(q1 + q2))*Q[1, 3]) + (0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) + 0.5*q2_dot*np.sin(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*((-1.0*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 1.0*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-1.0*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 1.0*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-1.0*np.sin(q1) - 1.0*np.sin(q1 + q2))*Q[0, 2] + (np.cos(q1) + np.cos(q1 + q2))*Q[1, 2]) + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3]) + (-np.sin(q1) - np.sin(q1 + q2))*((-1.0*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 1.0*q2_dot*np.sin(q1 + q2))*Q[3, 0] + (-1.0*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 1.0*q2_dot*np.cos(q1 + q2))*Q[2, 0] + (-1.0*np.sin(q1) - 1.0*np.sin(q1 + q2))*Q[0, 0] + (np.cos(q1) + np.cos(q1 + q2))*Q[1, 0]) + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 1] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 1] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 1] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 1]) + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 0] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 0] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 0] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 0]) + (np.cos(q1) + np.cos(q1 + q2))*((-1.0*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 1.0*q2_dot*np.sin(q1 + q2))*Q[3, 1] + (-1.0*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 1.0*q2_dot*np.cos(q1 + q2))*Q[2, 1] + (-1.0*np.sin(q1) - 1.0*np.sin(q1 + q2))*Q[0, 1] + (np.cos(q1) + np.cos(q1 + q2))*Q[1, 1]) + (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*((0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) + 0.5*q2_dot*np.sin(q1 + q2))*Q[2, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[3, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[1, 2] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[0, 2]) + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*((0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) + 0.5*q2_dot*np.sin(q1 + q2))*Q[2, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[3, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[1, 3] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[0, 3]) + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*((0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) + 0.5*q2_dot*np.sin(q1 + q2))*Q[2, 1] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[3, 1] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[1, 1] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[0, 1]) + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*((0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) + 0.5*q2_dot*np.sin(q1 + q2))*Q[2, 0] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[3, 0] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[1, 0] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[0, 0]), -(q1_dot + q2_dot)*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3])*np.sin(q1 + q2) + 0.5*(q1_dot + q2_dot)*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.sin(q1 + q2) - 0.5*(q1_dot + q2_dot)*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.cos(q1 + q2) + (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2] + 0.5*np.cos(q1 + q2)*Q[1, 2]) + (-np.sin(q1) - np.sin(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 0] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 0] - 0.5*np.sin(q1 + q2)*Q[0, 0] + 0.5*np.cos(q1 + q2)*Q[1, 0]) + (np.cos(q1) + np.cos(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 1] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 1] - 0.5*np.sin(q1 + q2)*Q[0, 1] + 0.5*np.cos(q1 + q2)*Q[1, 1]) + (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 2] - 0.5*np.sin(q1 + q2)*Q[1, 2] - 0.5*np.cos(q1 + q2)*Q[0, 2]) + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 3] - 0.5*np.sin(q1 + q2)*Q[1, 3] - 0.5*np.cos(q1 + q2)*Q[0, 3]) + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 1] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 1] - 0.5*np.sin(q1 + q2)*Q[1, 1] - 0.5*np.cos(q1 + q2)*Q[0, 1]) + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 0] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 0] - 0.5*np.sin(q1 + q2)*Q[1, 0] - 0.5*np.cos(q1 + q2)*Q[0, 0]) - ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 0] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 0] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 0])*np.sin(q1 + q2) + ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 1] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 1] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 1])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 0] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 0] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 0] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 0])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 1] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 1] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 1] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 1])*np.sin(q1 + q2), (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 0])*(-np.sin(q1) - np.sin(q1 + q2)) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 1])*(np.cos(q1) + np.cos(q1 + q2)) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 0] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 1] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 2] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 3] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) + (-np.sin(q1) - np.sin(q1 + q2))*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2]) + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3]) + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2]) + (np.cos(q1) + np.cos(q1 + q2))*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3]), (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*(-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*(-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2]) + (-0.5*np.sin(q1 + q2)*Q[2, 0] + 0.5*np.cos(q1 + q2)*Q[3, 0])*(-np.sin(q1) - np.sin(q1 + q2)) + (-0.5*np.sin(q1 + q2)*Q[2, 1] + 0.5*np.cos(q1 + q2)*Q[3, 1])*(np.cos(q1) + np.cos(q1 + q2)) + (-0.5*np.sin(q1 + q2)*Q[3, 0] - 0.5*np.cos(q1 + q2)*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[3, 1] - 0.5*np.cos(q1 + q2)*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[3, 2] - 0.5*np.cos(q1 + q2)*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[3, 3] - 0.5*np.cos(q1 + q2)*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) - ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2])*np.sin(q1 + q2) + ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.sin(q1 + q2)],[-(q1_dot + q2_dot)*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3])*np.sin(q1 + q2) + 0.5*(q1_dot + q2_dot)*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.sin(q1 + q2) - 0.5*(q1_dot + q2_dot)*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.cos(q1 + q2) + (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2] + 0.5*np.cos(q1 + q2)*Q[1, 2]) + (-np.sin(q1) - np.sin(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 0] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 0] - 0.5*np.sin(q1 + q2)*Q[0, 0] + 0.5*np.cos(q1 + q2)*Q[1, 0]) + (np.cos(q1) + np.cos(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 1] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 1] - 0.5*np.sin(q1 + q2)*Q[0, 1] + 0.5*np.cos(q1 + q2)*Q[1, 1]) + (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 2] - 0.5*np.sin(q1 + q2)*Q[1, 2] - 0.5*np.cos(q1 + q2)*Q[0, 2]) + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 3] - 0.5*np.sin(q1 + q2)*Q[1, 3] - 0.5*np.cos(q1 + q2)*Q[0, 3]) + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 1] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 1] - 0.5*np.sin(q1 + q2)*Q[1, 1] - 0.5*np.cos(q1 + q2)*Q[0, 1]) + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 0] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 0] - 0.5*np.sin(q1 + q2)*Q[1, 0] - 0.5*np.cos(q1 + q2)*Q[0, 0]) - ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 0] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 0] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 0])*np.sin(q1 + q2) + ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 1] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 1] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 1])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 0] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 0] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 0] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 0])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 1] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 1] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 1] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 1])*np.sin(q1 + q2), 0.5*(q1_dot + q2_dot)*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.sin(q1 + q2) - 0.5*(q1_dot + q2_dot)*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.cos(q1 + q2) - (q1_dot + q2_dot)*(-1.0*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 1.0*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 1.0*np.sin(q1 + q2)*Q[0, 2] + 1.0*np.cos(q1 + q2)*Q[1, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*(-1.0*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 1.0*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 1.0*np.sin(q1 + q2)*Q[0, 3] + 1.0*np.cos(q1 + q2)*Q[1, 3])*np.sin(q1 + q2) + (-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 2] - 0.5*np.sin(q1 + q2)*Q[1, 2] - 0.5*np.cos(q1 + q2)*Q[0, 2]) + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 3] - 0.5*np.sin(q1 + q2)*Q[1, 3] - 0.5*np.cos(q1 + q2)*Q[0, 3]) + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 1] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 1] - 0.5*np.sin(q1 + q2)*Q[1, 1] - 0.5*np.cos(q1 + q2)*Q[0, 1]) + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*(0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[2, 0] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[3, 0] - 0.5*np.sin(q1 + q2)*Q[1, 0] - 0.5*np.cos(q1 + q2)*Q[0, 0]) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 0] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 0] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 0] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 0])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 1] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 1] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 1] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 1])*np.sin(q1 + q2) - (-1.0*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 0] - 1.0*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 0] - 1.0*np.sin(q1 + q2)*Q[0, 0] + 1.0*np.cos(q1 + q2)*Q[1, 0])*np.sin(q1 + q2) + (-1.0*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 1] - 1.0*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 1] - 1.0*np.sin(q1 + q2)*Q[0, 1] + 1.0*np.cos(q1 + q2)*Q[1, 1])*np.cos(q1 + q2),-(q1_dot + q2_dot)*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3])*np.sin(q1 + q2) - ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 0])*np.sin(q1 + q2) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 1])*np.cos(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[3, 0] - 0.5*np.cos(q1 + q2)*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[3, 1] - 0.5*np.cos(q1 + q2)*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[3, 2] - 0.5*np.cos(q1 + q2)*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[3, 3] - 0.5*np.cos(q1 + q2)*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) + (-np.sin(q1) - np.sin(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2] + 0.5*np.cos(q1 + q2)*Q[1, 2]) + (np.cos(q1) + np.cos(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3]) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.sin(q1 + q2), -(q1_dot + q2_dot)*(-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*(-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3])*np.sin(q1 + q2) - (-0.5*np.sin(q1 + q2)*Q[2, 0] + 0.5*np.cos(q1 + q2)*Q[3, 0])*np.sin(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[2, 1] + 0.5*np.cos(q1 + q2)*Q[3, 1])*np.cos(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[3, 0] - 0.5*np.cos(q1 + q2)*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[3, 1] - 0.5*np.cos(q1 + q2)*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[3, 2] - 0.5*np.cos(q1 + q2)*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[3, 3] - 0.5*np.cos(q1 + q2)*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.sin(q1 + q2) - (-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2] + 0.5*np.cos(q1 + q2)*Q[1, 2])*np.sin(q1 + q2) + (-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3])*np.cos(q1 + q2)],[(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 0])*(-np.sin(q1) - np.sin(q1 + q2)) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 1])*(np.cos(q1) + np.cos(q1 + q2)) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 0] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 1] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 2] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[3, 3] + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) + (-np.sin(q1) - np.sin(q1 + q2))*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2]) + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3]) + (-0.5*np.cos(q1) - 0.5*np.cos(q1 + q2))*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2]) + (np.cos(q1) + np.cos(q1 + q2))*((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3]), -(q1_dot + q2_dot)*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3])*np.sin(q1 + q2) - ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 0] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 0])*np.sin(q1 + q2) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 1] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 1])*np.cos(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[3, 0] - 0.5*np.cos(q1 + q2)*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[3, 1] - 0.5*np.cos(q1 + q2)*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[3, 2] - 0.5*np.cos(q1 + q2)*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[3, 3] - 0.5*np.cos(q1 + q2)*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) + (-np.sin(q1) - np.sin(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2] + 0.5*np.cos(q1 + q2)*Q[1, 2]) + (np.cos(q1) + np.cos(q1 + q2))*(-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3]) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.sin(q1 + q2),((-1.0*np.sin(q1) - 1.0*np.sin(q1 + q2))*Q[2, 2] + (np.cos(q1) + np.cos(q1 + q2))*Q[3, 2])*(-np.sin(q1) - np.sin(q1 + q2)) + ((-1.0*np.sin(q1) - 1.0*np.sin(q1 + q2))*Q[2, 3] + (np.cos(q1) + np.cos(q1 + q2))*Q[3, 3])*(np.cos(q1) + np.cos(q1 + q2)),-((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2])*np.sin(q1 + q2) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3])*np.cos(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2])*(-np.sin(q1) - np.sin(q1 + q2)) + (-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3])*(np.cos(q1) + np.cos(q1 + q2))],[(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2))*(-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3]) + (-q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - q2_dot*np.cos(q1 + q2))*(-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2]) + (-0.5*np.sin(q1 + q2)*Q[2, 0] + 0.5*np.cos(q1 + q2)*Q[3, 0])*(-np.sin(q1) - np.sin(q1 + q2)) + (-0.5*np.sin(q1 + q2)*Q[2, 1] + 0.5*np.cos(q1 + q2)*Q[3, 1])*(np.cos(q1) + np.cos(q1 + q2)) + (-0.5*np.sin(q1 + q2)*Q[3, 0] - 0.5*np.cos(q1 + q2)*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[3, 1] - 0.5*np.cos(q1 + q2)*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[3, 2] - 0.5*np.cos(q1 + q2)*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[3, 3] - 0.5*np.cos(q1 + q2)*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) - ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 2] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 2] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 2])*np.sin(q1 + q2) + ((-0.5*q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - 0.5*q2_dot*np.sin(q1 + q2))*Q[3, 3] + (-0.5*q1_dot*(np.cos(q1) + np.cos(q1 + q2)) - 0.5*q2_dot*np.cos(q1 + q2))*Q[2, 3] + (-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[0, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[1, 3])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.sin(q1 + q2), -(q1_dot + q2_dot)*(-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2])*np.cos(q1 + q2) - (q1_dot + q2_dot)*(-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3])*np.sin(q1 + q2) - (-0.5*np.sin(q1 + q2)*Q[2, 0] + 0.5*np.cos(q1 + q2)*Q[3, 0])*np.sin(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[2, 1] + 0.5*np.cos(q1 + q2)*Q[3, 1])*np.cos(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[3, 0] - 0.5*np.cos(q1 + q2)*Q[2, 0])*(np.cos(q1) + np.cos(q1 + q2) - xg[0]) + (-0.5*np.sin(q1 + q2)*Q[3, 1] - 0.5*np.cos(q1 + q2)*Q[2, 1])*(np.sin(q1) + np.sin(q1 + q2) - xg[1]) + (-0.5*np.sin(q1 + q2)*Q[3, 2] - 0.5*np.cos(q1 + q2)*Q[2, 2])*(-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2]) + (-0.5*np.sin(q1 + q2)*Q[3, 3] - 0.5*np.cos(q1 + q2)*Q[2, 3])*(q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3]) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 2] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 2] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 2] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 2])*np.cos(q1 + q2) - 0.5*((-q1_dot*(np.sin(q1) + np.sin(q1 + q2)) - q2_dot*np.sin(q1 + q2) - xg[2])*Q[2, 3] + (q1_dot*(np.cos(q1) + np.cos(q1 + q2)) + q2_dot*np.cos(q1 + q2) - xg[3])*Q[3, 3] + (np.sin(q1) + np.sin(q1 + q2) - xg[1])*Q[1, 3] + (np.cos(q1) + np.cos(q1 + q2) - xg[0])*Q[0, 3])*np.sin(q1 + q2) - (-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 2] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 2] - 0.5*np.sin(q1 + q2)*Q[0, 2] + 0.5*np.cos(q1 + q2)*Q[1, 2])*np.sin(q1 + q2) + (-0.5*(q1_dot + q2_dot)*np.sin(q1 + q2)*Q[3, 3] - 0.5*(q1_dot + q2_dot)*np.cos(q1 + q2)*Q[2, 3] - 0.5*np.sin(q1 + q2)*Q[0, 3] + 0.5*np.cos(q1 + q2)*Q[1, 3])*np.cos(q1 + q2),-((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 2] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 2])*np.sin(q1 + q2) + ((-0.5*np.sin(q1) - 0.5*np.sin(q1 + q2))*Q[2, 3] + (0.5*np.cos(q1) + 0.5*np.cos(q1 + q2))*Q[3, 3])*np.cos(q1 + q2) + (-0.5*np.sin(q1 + q2)*Q[2, 2] + 0.5*np.cos(q1 + q2)*Q[3, 2])*(-np.sin(q1) - np.sin(q1 + q2)) + (-0.5*np.sin(q1 + q2)*Q[2, 3] + 0.5*np.cos(q1 + q2)*Q[3, 3])*(np.cos(q1) + np.cos(q1 + q2)), -(-1.0*np.sin(q1 + q2)*Q[2, 2] + 1.0*np.cos(q1 + q2)*Q[3, 2])*np.sin(q1 + q2) + (-1.0*np.sin(q1 + q2)*Q[2, 3] + 1.0*np.cos(q1 + q2)*Q[3, 3])*np.cos(q1 + q2)]])

